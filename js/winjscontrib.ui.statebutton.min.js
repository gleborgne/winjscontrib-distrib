/* 
 * WinJS Contrib v2.0.1.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{StateButton:WinJS.Class.mix(WinJS.Class.define(function(e,t){var n=this;n.element=e||document.createElement("DIV"),t=t||{},n.element.winControl=n,n.element.classList.add("mcn-statebutton"),n.element.classList.add("win-disposable"),n.states={},$(n.element).tap(n._buttonClicked.bind(n)),n._loadContent(t),WinJS.UI.setOptions(n,t),n.duration=n.duration||600,n.rotation=n.rotation||"none",n.easing=n.easing||"elastic-out"},{_loadObjContent:function(e){var t=this;t._obj=document.createElement("object"),t.element.appendChild(t._obj),t._obj.onload=function(){t.morpheus=new SVGMorpheus(t._obj,{iconId:"play_arrow",rotation:"none",duration:0}),t.morpheus.to("play_arrow",{duration:1,rotation:"none"})},t._obj.className="mcn-statebutton-icon",t._obj.setAttribute("type","image/svg+xml"),t._obj.setAttribute("data",e.iconset)},_loadSvgContent:function(e){var t=this;return WinJS.xhr({url:e.iconset}).then(function(e){if(e.responseXML){var n=e.responseXML.getElementsByTagName("svg");t.svg=n[0],t.element.appendChild(t.svg),t.morpheus=new SVGMorpheus(t.svg),t._stateName=t.defaultState,t.morpheus.to(t.state,{duration:1,rotation:"none"})}},function(){})},_loadContent:function(e){return e.iconset?this._loadSvgContent(e):void 0},_runState:function(e){var t=this;if(!e&&t.action){var n=WinJSContrib.Utils.resolveMethod(t.element,t.action);if(n)return WinJS.Promise.as(n(t.element))}if(t.morpheus){var i=t.states[e];if(i){var o=WinJS.Promise.wrap();if(i.action){var n=WinJSContrib.Utils.resolveMethod(t.element,i.action);n&&(o=WinJS.Promise.as(n(t.element)))}return o.then(function(){i["goto"]&&t.states[i["goto"]]&&(t._stateName=i["goto"],t.morpheus.to(i["goto"],{duration:t.duration,rotation:t.rotation,easing:t.easing}))})}}return WinJS.Promise.wrapError()},_buttonClicked:function(){var e=this;clearTimeout(e.clearError),e.element.classList.remove("mcn-success"),e.element.classList.remove("mcn-error"),e.clearPending=setTimeout(function(){e.element.classList.add("mcn-pending")},50),e._runState(e.state).then(function(t){clearTimeout(e.clearPending),e.element.classList.remove("mcn-pending"),e.element.classList.add("mcn-success"),e.dispatchEvent("success",t)},function(t){e.dispatchEvent("error",t),clearTimeout(e.clearPending),e.element.classList.add("mcn-error")})},state:{get:function(){return this._stateName},set:function(e){var t=this;t._stateName=e}},addState:function(){},dispose:function(){WinJS.Utilities.disposeSubTree(this.element)}}),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("myevent"))})}();