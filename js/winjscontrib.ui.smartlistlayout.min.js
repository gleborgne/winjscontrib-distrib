/* 
 * WinJS Contrib v2.1.0.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{SmartListLayout:WinJS.Class.define(function(t,i){this._element=t||document.createElement("div"),this._element.className=this._element.className+" win-disposable mcn-layout-ctrl",this._element.winControl=this,this.queries=[],this.listView=i?i.listView:void 0,this.listView&&this.listView.winControl&&i.layouts&&(this.initQueries(i.layouts),this.applyPendingLayout())},{listView:{get:function(){return this._listview},set:function(t){this._listview=t&&t.element&&t.forceLayout?t.element:t}},initQueries:function(t){var i=this;for(var e in t)t.hasOwnProperty(e)&&i.add(t[e])},add:function(t){var i=this;if(t&&t.query&&t.layout){var e={ctrl:i,mediaquery:t.query,layout:t.layout,options:t.options,mq:void 0,bindedCallback:void 0};e.bindedCallback=i.processQuery.bind(e),i.queries.push(e),e.mq=window.matchMedia(t.query),e.mq.addListener(e.bindedCallback),e.mq.matches&&i.applyQuery(e)}},processQuery:function(){var t=this;t.ctrl.applyQuery(t)},applyQuery:function(t){var i=this;t.mq.matches&&i.listView&&i.listView.winControl&&(i.pendingLayout||(i.listView.style.opacity=0,setImmediate(function(){i.applyPendingLayout()})),i.pendingLayout=new t.layout(t.options))},applyPendingLayout:function(){var t=this;t.pendingLayout&&(t.listView.winControl.layout=t.pendingLayout,t.listView.style.opacity=1,t.listView.winControl.forceLayout(),t.pendingLayout=void 0)},updateLayout:function(){},contentReady:function(){},dispose:function(){var t=this;t.queries.forEach(function(t){t.mq.removeListener(t.bindedCallback)})}})}),WinJSContrib.UI.WebComponents&&WinJSContrib.UI.WebComponents.register("mcn-smartlistlayout",WinJSContrib.UI.SmartListLayout,function(t,i){return WinJSContrib.UI.WebComponents.mapAttr(t,"listView",i),WinJSContrib.UI.WebComponents.mapAttr(t,"layouts",i),i})}();