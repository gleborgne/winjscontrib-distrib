/* 
 * WinJS Contrib v2.0.1.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var worker=this;!function(){"use strict";importScripts("//Microsoft.WinJS.2.0/js/base.js"),importScripts("/scripts/winjscontrib/winjscontrib.core.js"),importScripts("/scripts/winjscontrib/winjscontrib.messenger.js"),importScripts("/scripts/winjscontrib/winjscontrib.search.js");var i=null,n=new WinJSContrib.Messenger(worker,worker);n.init=function(n){return i=new WinJSContrib.Search.Index,i.name=n.name,i.definition=n.definition,n.load?i.load():void 0},n.save=function(){return i.name&&i.definition?i.save():WinJS.Promise.wrapError({message:"index not initialized"})},n.load=function(){return i.name?i.load():WinJS.Promise.wrapError({message:"index not initialized"})},n.count=function(){return i.name&&i.definition?i.items.length:WinJS.Promise.wrapError({message:"index not initialized"})},n.index=function(n){return new WinJS.Promise(function(e,o,t){try{if(n.options&&n.options.index&&(i.name=n.options.index.name,n.options.index.definition&&(i.definition=n.options.index.definition)),!i.name||!i.definition)return void o({message:"index not initialized"});if(n.options&&n.options.load)var r=i.load();else var r=WinJS.Promise.wrap();r.done(function(){var r=i.addRange(n.items,null,t);n.options&&n.options.save?i.save().done(function(){e({name:i.name,items:r})},o):e({name:i.name,items:r})},o)}catch(s){o(s)}})},n.search=function(n){return new WinJS.Promise(function(e,o){try{if(n.options&&n.options.index&&(i.name=n.options.index.name,n.options.index.definition&&(i.definition=n.options.index.definition)),!i.name||!i.definition)return void o({message:"index not initialized"});if(n.options&&n.options.load)var t=i.load();else var t=WinJS.Promise.wrap();t.done(function(){var o=i.search(n.searchTerm);e(o)},o)}catch(r){o(r)}})},n.clear=function(){return i.name&&i.definition?i.clear():WinJS.Promise.wrapError({message:"index not initialized"})}}();