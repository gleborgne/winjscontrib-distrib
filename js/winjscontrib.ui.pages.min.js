/* 
 * WinJS Contrib v2.0.3.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var profiler=window.msWriteProfilerMark||function(){},WinJSContrib;!function(e){var t;!function(t){var n;!function(){!function(t,n,r,i,o,s,a,c,u,l){"use strict";function f(e){var t=n.document.createElement("a");return t.href=e,t.href}function p(e){return n.document.location.href.toLowerCase()===e.toLowerCase()}function d(e,t){return t?(t.__proto__.hasOwnProperty("hasOwnProperty")||d(e,t.__proto__),r.Class.mix(e,t)):e}function h(e,t){return t?"function"==typeof t?(e.prototype._attachedConstructors||(e.prototype._attachedConstructors=[]),e.prototype._attachedConstructors.push(t),d(e,t.prototype)):"object"==typeof t?r.Class.mix(e,t):e:e}function m(i,u){var l=f(i).toLowerCase(),d=y[l];return i=f(i),d||(d=r.Class.define(function(t,r,u,l){var f=this;f._pageLifeCycle={created:new Date,processQueue:[]},this._disposed=!1,this.element=t=t||n.document.createElement("div"),s.addClass(t,"win-disposable"),t.msSourceLocation=i,this.uri=i,this.selfhost=p(i),t.winControl=this,f.parentedComplete=l,s.addClass(t,"pagecontrol");var d=" uri='"+i+"'"+o._getProfilerMarkIdentifier(this.element);a("WinJS.UI.Pages:createPage"+d+",StartTM"),e.UI.WebComponents&&(f.observer=e.UI.WebComponents.watch(this.element));var h=c.timeout().then(function(){return f.load(i)}),m=h.then(function(e){return f._attachedConstructors&&f._attachedConstructors.forEach(function(e){e.apply(f,[t,r])}),c.join({loadResult:e,initResult:f.init(t,r)})}).then(function(e){return f.render(t,r,e.loadResult)}).then(function(){return e.UI.WebComponents?WinJS.Promise.timeout():void 0});this.elementReady=m.then(function(){return t}),this.renderComplete=m.then(function(){if(f._pageLifeCycle.processQueue&&f._pageLifeCycle.processQueue.length){var e=[];return f._pageLifeCycle.processQueue.forEach(function(e){return WinJS.Promise.as(e())}),WinJS.Promise.join(e).then(function(){f._pageLifeCycle.processQueue=null})}}).then(function(){return f.process(t,r)}).then(function(){return f.processed(t,r)});var _=function(){u&&u(f),a("WinJS.UI.Pages:createPage"+d+",StopTM")};this.renderComplete.then(_,_),this.readyComplete=this.renderComplete.then(function(){return l}).then(function(){return f.ready(t,r),f._pageLifeCycle.ended=new Date,f._pageLifeCycle.delta=f._pageLifeCycle.ended-f._pageLifeCycle.created,console.log("navigation to "+i+" took "+f._pageLifeCycle.delta+"ms"),f}).then(null,function(e){return f.error?f.error(e):void 0})},P),d=r.Class.mix(d,WinJS.UI.DOMEventMixin),t.defaultPageMixins.forEach(function(e){var t=d.prototype.dispose;d=r.Class.mix(d,e),t&&e.hasOwnProperty("dispose")&&(d.prototype.dispose=function(){t.apply(this),e.dispose.apply(this)})}),e.UI.Pages.fragmentMixin(d),y[l]=d),d=h(d,u),d.selfhost=p(i),d}function _(e,t){var r=y[e];return r||(r=m(e)),t&&(r=h(r,t)),r.selfhost&&WinJS.Utilities.ready(function(){v(f(e),n.document.body)},!0),r}function v(e,t,n,r){var o=i.get(e),s=new o(t,n,null,r);return s.renderComplete.then(null,function(e){return c.wrapError({error:e,page:s})})}function g(e){var t=y[e];return t||(t=_(e)),t}function C(e){u.clearCache(f(e)),delete y[e.toLowerCase()]}var y=i._viewMap||{};t.defaultPageMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var t=this.element.querySelectorAll(e);t&&!t.forEach&&(t.forEach=function(e){for(var n=0;n<t.length;n++)e(t[n],n)})}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var t=0;t<e.promises.length;t++)e.promises[t]&&e.promises[t].cancel()}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}}}];var P={dispose:function(){this._disposed||(this._disposed=!0,s.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:u.renderCopy(f(e))},process:function(e){return l.processAll(e)},processed:function(){},render:function(e,t,n){return this.selfhost||e.appendChild(n),e},ready:function(){}};t._corePages={get:i.get,render:i.render,define:i.define,_remove:i._remove,_viewMap:i._viewMap};var S={define:_,get:g,render:v,_remove:C,_viewMap:y},w=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(t,null,S),w.get=S.get,w.define=S.define,w.render=S.render,w._remove=S._remove}(e.UI.Pages,window,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,profiler,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(n=t.Pages||(t.Pages={}))}(t=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));