/* 
 * WinJS Contrib v2.0.1.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib;!function(e){var t;!function(t){var n;!function(){!function(t,n,r,i,o,s,a,u,c,l){"use strict";function f(e){var t=n.document.createElement("a");return t.href=e,t.href}function h(e){return n.document.location.href.toLowerCase()===e.toLowerCase()}function d(e,t){return t?(t.__proto__.hasOwnProperty("hasOwnProperty")||d(e,t.__proto__),r.Class.mix(e,t)):e}function p(e,t){return t?"function"==typeof t?(e.prototype._attachedConstructors||(e.prototype._attachedConstructors=[]),e.prototype._attachedConstructors.push(t),d(e,t.prototype)):"object"==typeof t?r.Class.mix(e,t):e:e}function m(i,c){var l=f(i).toLowerCase(),d=y[l];return i=f(i),d||(d=r.Class.define(function(t,r,c,l){var f=this;this._disposed=!1,this.element=t=t||n.document.createElement("div"),s.addClass(t,"win-disposable"),t.msSourceLocation=i,this.uri=i,this.selfhost=h(i),t.winControl=this,f.parentedComplete=l,s.addClass(t,"pagecontrol");var d=" uri='"+i+"'"+o._getProfilerMarkIdentifier(this.element);a("WinJS.UI.Pages:createPage"+d+",StartTM");var p=u.timeout().then(function(){return f.load(i)}),m=p.then(function(e){return f._attachedConstructors&&f._attachedConstructors.forEach(function(e){e.apply(f,[t,r])}),u.join({loadResult:e,initResult:f.init(t,r)})}).then(function(e){return f.render(t,r,e.loadResult)});this.elementReady=m.then(function(){return t}),this.renderComplete=m.then(function(){return f.process(t,r)}).then(function(){return f.processed(t,r)}).then(function(){return e.UI.bindMembers(t,f),e.UI.bindActions(t,f),f});var v=function(){c&&c(f),a("WinJS.UI.Pages:createPage"+d+",StopTM")};this.renderComplete.then(v,v),this.readyComplete=this.renderComplete.then(function(){return l}).then(function(){return f.ready(t,r),f}).then(null,function(e){return f.error?f.error(e):void 0})},S),d=r.Class.mix(d,WinJS.UI.DOMEventMixin),d.winJSContrib=!0,t.defaultPageMixins.forEach(function(e){var t=d.prototype.dispose;d=r.Class.mix(d,e),t&&e.hasOwnProperty("dispose")&&(d.prototype.dispose=function(){t.apply(this),e.dispose.apply(this)})}),y[l]=d),d=p(d,c),d.selfhost=h(i),d}function v(e,t){var r=y[e];return r||(r=m(e)),t&&(r=p(r,t)),r.selfhost&&WinJS.Utilities.ready(function(){_(f(e),n.document.body)},!0),r}function _(e,t,n,r){var o=i.get(e),s=new o(t,n,null,r);return s.renderComplete.then(null,function(e){return u.wrapError({error:e,page:s})})}function C(e){var t=y[e];return t||(t=v(e)),t}function g(e){c.clearCache(f(e)),delete y[e.toLowerCase()]}var y=i._viewMap||{};t.defaultPageMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var t=this.element.querySelectorAll(e);t&&!t.forEach&&(t.forEach=function(e){for(var n=0;n<t.length;n++)e(t[n],n)})}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var t=0;t<e.promises.length;t++)e.promises[t]&&e.promises[t].cancel()}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}}}];var S={dispose:function(){this._disposed||(this._disposed=!0,s.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:c.renderCopy(f(e))},process:function(e){return l.processAll(e)},processed:function(){},render:function(e,t,n){return this.selfhost||e.appendChild(n),e},ready:function(){}};t._corePages={get:i.get,render:i.render,define:i.define,_remove:i._remove,_viewMap:i._viewMap};var P={define:v,get:C,render:_,_remove:g,_viewMap:y},w=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(t,null,P),w.get=P.get,w.define=P.define,w.render=P.render,w._remove=P._remove}(e.UI.Pages,window,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,msWriteProfilerMark,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(n=t.Pages||(t.Pages={}))}(t=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));