!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{parentFlyoutPage:function(e){if(!e)return null;for(var n=e.parentNode;n;){if(n.mcnFlyoutPage)return n.winControl;n=n.parentNode}},FlyoutPage:WinJS.Class.mix(WinJS.Class.define(function(e,n){var t=this;t.element=e||document.createElement("DIV"),n=n||{},t.element.mcnFlyoutPage=!0,t.element.winControl=t,t.element.classList.add("mcn-flyoutpage"),t.element.classList.add("mcn-flyout"),t.element.classList.add("win-disposable"),t.hardwareBackBtnPressedBinded=t.hardwareBackBtnPressed.bind(t),t.cancelNavigationBinded=t.cancelNavigation.bind(t),WinJS.UI.setOptions(this,n),t.enterAnimation||(t.enterAnimation=n.enterAnimation||WinJS.UI.Animation.enterPage),t.exitAnimation||(t.exitAnimation=n.exitAnimation||WinJS.UI.Animation.exitPage),t._container=document.createElement("DIV"),t._container.className="mcn-flyoutpage-area",t._overlay=document.createElement("DIV"),t._overlay.className="mcn-flyoutpage-overlay",t._overlay.innerHTML='<DIV class="mcn-flyoutpage-overlay-bg"></DIV>',t._container.appendChild(t._overlay),t._overlay.onclick=function(){t.hide()},t._wrapper=document.createElement("DIV"),t._wrapper.className="mcn-flyoutpage-contentwrapper",t._container.appendChild(t._wrapper),t._wrapperArea=document.createElement("DIV"),t._wrapperArea.className="mcn-flyoutpage-contentwrapperarea",t._wrapper.appendChild(t._wrapperArea),t._bg=document.createElement("DIV"),t._bg.className="mcn-flyoutpage-bg",t._wrapperArea.appendChild(t._bg),t._content=document.createElement("DIV"),t._content.className="mcn-flyoutpage-content",t._wrapperArea.appendChild(t._content),n.uri?new WinJS.UI.HtmlControl(t._content,{uri:n.uri},function(e){t.contentCtrl=e,WinJSContrib.UI.bindMembers(e.element,e),e.flyoutPage=t,t.bindLinks()}):(WinJSContrib.Utils.moveChilds(t.element,t._content),t.bindLinks()),t.element.appendChild(t._container)},{content:{get:function(){return this._content}},placement:{get:function(){return this._placement},set:function(e){var n=this;this._placement=e,"right"==this._placement?(n.element.classList.add("partial-right"),n.enterAnimation||(n.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromRight(e,{duration:300})}),n.exitAnimation||(n.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToRight(e,{duration:120})})):"left"==this._placement?(n.element.classList.add("partial-left"),n.enterAnimation||(n.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromLeft(e,{duration:300})}),n.exitAnimation||(n.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToLeft(e,{duration:120})})):"bottom"==this._placement?(n.element.classList.add("partial-bottom"),n.enterAnimation||(n.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromBottom(e,{duration:300})}),n.exitAnimation||(n.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToBottom(e,{duration:120})})):"top"==this._placement&&(n.element.classList.add("partial-top"),n.enterAnimation||(n.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromTop(e,{duration:300})}),n.exitAnimation||(n.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToTop(e,{duration:120})}))}},hardwareBackBtnPressed:function(e){var n=this,t=WinJSContrib.UI.FlyoutPage.openPages.indexOf(n);t==WinJSContrib.UI.FlyoutPage.openPages.length-1&&(n.hide(),e.handled=!0,e.preventDefault&&e.preventDefault())},cancelNavigation:function(e){var n=new WinJS.Promise(function(){});e.detail.setPromise(n),setImmediate(function(){n.cancel()})},addContentElement:function(e){var n=this;n._content.appendChild(e)},pick:function(e,n){var t=this;n=n||{},n.uri=e;var i=new WinJS.Promise(function(e){new WinJS.UI.HtmlControl(t._content,n,function(n){t.contentCtrl=n,n.close=function(e){t.hide(e)},n.flyoutPage=t,WinJSContrib.UI.bindMembers(n.element,n),t.bindLinks(),t.show(),t.onbeforehide=function(){t.onbeforehide=null;var n=t.result;setImmediate(function(){e(n)})},t.onafterhide=function(){t.onafterhide=null,WinJS.Utilities.disposeSubTree(t._content),t.contentCtrl.unload&&t.contentCtrl.unload(),t.contentCtrl=null,t._content.innerHTML=""}})});return i},show:function(){var e=this;e.contentCtrl&&e.contentCtrl.beforeshow&&e.contentCtrl.beforeshow(),this.dispatchEvent("beforeshow"),e.element.classList.add("visible"),e._wrapper.classList.add("visible"),e._wrapper.style.opacity="0",e._overlay.style.opacity="0",e._overlay.classList.add("visible"),WinJS.Navigation.addEventListener("beforenavigate",this.cancelNavigationBinded),window.Windows&&window.Windows.Phone?Windows.Phone.UI.Input.HardwareButtons.addEventListener("backpressed",this.hardwareBackBtnPressedBinded):document.addEventListener("backbutton",this.hardwareBackBtnPressedBinded,!0),WinJSContrib.UI.Animation.fadeIn(e._overlay,400);var n=WinJS.Promise.wrap();return e.contentCtrl&&e.contentCtrl.beforeShowContent&&(n=WinJS.Promise.as(e.contentCtrl.beforeShowContent())),n.then(function(){return WinJS.Promise.timeout()}).then(function(){return e.calcAutosize(),WinJS.Promise.timeout()}).then(function(){return e.enterAnimation(e._wrapper)}).then(function(){WinJSContrib.UI.FlyoutPage.openPages.push(e),e.contentCtrl&&e.contentCtrl.aftershow&&e.contentCtrl.aftershow(),e.dispatchEvent("aftershow"),WinJSContrib.UI.Application&&WinJSContrib.UI.Application.navigator&&WinJSContrib.UI.Application.navigator.addLock()})},calcAutosize:function(){var e=this;if(e.autosize)if("top"==e.placement||"bottom"==e.placement){var n=$(".mcn-flyoutpage-content",e.element).children().first(),t=n.outerHeight();$(".mcn-flyoutpage-contentwrapper",e.element).height(t)}else if("left"==e.placement||"right"==e.placement){var n=$(".mcn-flyoutpage-content",e.element).children().first(),t=n.outerWidth();$(".mcn-flyoutpage-contentwrapper",e.element).width(t)}},hide:function(e){var n=this;return n.result=e,n.contentCtrl&&n.contentCtrl.beforehide&&n.contentCtrl.beforehide(),this.dispatchEvent("beforehide"),WinJSContrib.UI.Application&&WinJSContrib.UI.Application.navigator&&WinJSContrib.UI.Application.navigator.removeLock(),WinJS.Navigation.removeEventListener("beforenavigate",this.cancelNavigationBinded),window.Windows&&window.Windows.Phone?Windows.Phone.UI.Input.HardwareButtons.removeEventListener("backpressed",this.hardwareBackBtnPressedBinded):document.removeEventListener("backbutton",this.hardwareBackBtnPressedBinded),WinJS.Promise.join([n.exitAnimation(n._wrapper),WinJSContrib.UI.Animation.fadeOut(n._overlay,200)]).then(function(){return WinJS.Promise.timeout(100)}).then(function(){n._wrapper.classList.remove("visible"),$(".mcn-flyoutpage-contentwrapper",n.element).css("width","").css("height","")}).then(function(){var e=WinJSContrib.UI.FlyoutPage.openPages.indexOf(n);WinJSContrib.UI.FlyoutPage.openPages.splice(e,1),n._wrapper.style.opacity="",n._overlay.style.opacity="",n._overlay.classList.remove("visible"),n.element.classList.remove("visible"),n.contentCtrl&&n.contentCtrl.afterhide&&n.contentCtrl.afterhide(),n.dispatchEvent("afterhide")})},bindLinks:function(){var e=this;$("*[data-flyout]",e.element).each(function(){var n=$(this).data("flyout");n&&$(this).tap(function(){var t=$(n);t.length&&t[0].winControl&&t[0].winControl.show&&(e.element.style.zIndex="500",e.hide().done(function(){e.element.style.zIndex=""}),t[0].winControl.show())})}),$("*[data-link]",e.element).each(function(){var n=$(this).data("link");if(n&&n.indexOf("/")<0){var t=WinJSContrib.Utils.readProperty(window,n);t&&(n=t)}n&&$(this).tap(function(t){var i=$(t).data("link-args");if(i&&"string"==typeof i)try{var o=WinJSContrib.Utils.readValue(t,i);i=o?o:JSON.parse(i)}catch(a){return}e.hide().then(function(){WinJS.Navigation.navigate(n,i)})})}),$("*[data-action]",e.element).each(function(){var n=$(this).data("action"),t=e._content.winControl[n];t&&"function"==typeof t&&$(this).tap(function(t){var i=$(t).data("action-args");if(i&&"string"==typeof i)try{var o=WinJSContrib.Utils.readValue(t,i);i=o?o:JSON.parse(i)}catch(a){return}e.hide().then(function(){e._content.winControl[n].bind(e._content.winControl)({elt:t,args:i})})})})},dispose:function(){WinJS.Utilities.disposeSubTree(this.element)}}),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("beforeshow","beforehide","aftershow","afterhide"))}),WinJSContrib.UI.FlyoutPage.openPages=[],WinJS.Namespace.define("WinJSContrib.UI",{FlyoutPicker:WinJS.Class.mix(WinJS.Class.define(function(e,n){var t=this;t.element=e||document.createElement("DIV"),n=n||{},t.element.style.display="none",t.element.classList.add("mcn-flyoutpicker"),t.element.classList.add("win-disposable"),t.element.mcnFlyoutPage=!0,t.element.winControl=t,t.flyoutPage=new WinJSContrib.UI.FlyoutPage(null,n);var i=WinJSContrib.UI.parentFlyoutPage(e);i?i.addContentElement(t.flyoutPage.element):document.body.appendChild(t.flyoutPage.element)},{dispose:function(){var e=this;$(e.flyoutPage.element).remove(),$(e.element).remove(),e.flyoutPage=null},addContentElement:function(e){var n=this;n.flyoutPage.addContentElement(e)},pick:function(e,n){var t=this;return t.flyoutPage.pick(e,n)}}),WinJS.UI.DOMEventMixin,WinJS.Utilities.createEventProperties(""))})}();