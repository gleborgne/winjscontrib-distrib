/* 
 * WinJS Contrib v2.0.3.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib;!function(n){var e;!function(e){var t;!function(e){function t(e,t){var r=WinJS.UI.Pages.define(e,t);return n.UI.Pages.fragmentMixin(r),r}function r(e){var t=e.prototype;if(!e.winJSContrib){if(e.winJSContrib=!0,n.UI.Pages.defaultFragmentMixins.forEach(function(n){WinJS.Class.mix(e,n)}),!t.__wLoad){t.__wLoad=t.load,t.load=function(){return WinJS.Promise.as(this.__wLoad.apply(this,arguments)).then(function(n){return t.__wInit||r(t),n})};var r=function(e){e.__wDispose=e.dispose,e.__wInit=e.init,e.__wProcessed=e.processed,e.__wReady=e.ready,e.__wUpdateLayout=e.updateLayout,e.init=function(n){return n.classList.add("mcn-fragment"),n.classList.add("mcn-layout-ctrl"),n.style.display&&(this._initialDisplay=n.style.display),n.style.display="none",this.__wInit.apply(this,arguments)},e.processed=function(e,t){var r=this,o=arguments;return n.UI.bindMembers(e,r),WinJS.Promise.as(r.__wProcessed.apply(r,o)).then(function(){e.style.display=r._initialDisplay||"";e.getBoundingClientRect();return i(r,e,"pageLayout",[e,t],null,r.pageLayout)})},e.ready=function(e,t){var r=this;return n.UI.bindActions(e,this),WinJS.Promise.as(r.__wReady.apply(r,arguments)).then(function(){return r.onafterready?r.onafterready(e,t):void 0}).then(function(){return i(r,e,"pageReady",[e,t])})},e.dispose=function(){n.UI.untapAll(this.element),this.eventTracker&&(this.eventTracker.dispose(),this._eventTracker=null),this.promises&&this.cancelPromises&&(this.cancelPromises(),this._promises=[]),this.__wDispose&&this.__wDispose(this)},e.updateLayout=function(){var n=this,e=arguments,t=WinJS.Promise.wrap();return n.__wUpdateLayout&&(t=WinJS.Promise.as(n.__wUpdateLayout.apply(n,e))),t.then(function(){return i(n,n.element,"updateLayout",e)})}}}return e}}function i(n,e,t,r,i,o){var a=[];i&&a.push(WinJS.Promise.as(i.apply(n,r)));var s=e.querySelectorAll(".mcn-layout-ctrl");if(s&&s.length){for(var c=0,u=s.length;u>c;){var p=s[c];if(p){var l=p.winControl[t];l&&a.push(WinJS.Promise.as(l.apply(p.winControl,r)))}c+=1}return o&&a.push(WinJS.Promise.as(o.apply(n,r))),WinJS.Promise.join(a)}return WinJS.Promise.wrap()}function o(e,t,r,i){function o(e){r&&r.injectToPage&&n.Utils.inject(e,r.injectToPage),e.navigationState={location:t,state:r},i.oncreate&&i.oncreate(e.element,r),i.oninit&&e.elementReady.then(function(){i.oninit(e.element,r)}),i.onrender&&e.renderComplete.then(function(){i.onrender(e.element,r)}),i.onready&&e.renderComplete.then(function(){return e.readyComplete}).then(function(){i.onready(e.element,r)}),(e.enterPageAnimation||i.enterPage)&&(e._enterAnimation=e.enterPageAnimation?e.enterPageAnimation:i.enterPage,e.enterPageAnimation=function(){var n=this,e=null;return c.style.opacity="",e=n&&n.getAnimationElements?n.getAnimationElements(!1):n.element,e?n._enterAnimation(e):void 0}),i.closeOldPagePromise&&(e._beforelayoutPromise=i.closeOldPagePromise,e.onbeforelayout=function(){return this._beforelayoutPromise}),e.beforeShow||(e.beforeShow=[]),e.contentReadyComplete=e.renderComplete.then(function(){return n.UI.disableAutoResources?void 0:WinJS.Resources.processAll(c)}).then(function(){return e.elementReady}).then(function(){return p}).then(function(){return e.beforeShow.length?n.Promise.parallel(e.beforeShow,function(n){return WinJS.Promise.as(n())}):void 0}).then(function(){return e.enterPageAnimation?WinJS.Promise.as(e.enterPageAnimation(c,i)):void(e.element.style.opacity="")}).then(a,s)}var a,s;i=i||{};var c=document.createElement("div");c.setAttribute("dir",window.getComputedStyle(c,null).direction),c.style.opacity="0",e.appendChild(c);var u=new WinJS.Promise(function(n,e){a=n,s=e}),p=i.parented?WinJS.Promise.as(i.parented):null,l=WinJS.UI.Pages.get(t);return n.UI.Pages.fragmentMixin(l),setImmediate(function(){new l(c,r,o,p)}),u}e.defaultFragmentMixins=[{$:function(n){return $(n,this.element||this._element)},q:function(n){return this.element.querySelector(n)},qAll:function(n){var e=this.element.querySelectorAll(n);e&&!e.forEach&&(e.forEach=function(n){for(var t=0;t<e.length;t++)n(e[t],t)})},eventTracker:{get:function(){return this._eventTracker||(this._eventTracker=new n.UI.EventTracker),this._eventTracker}},promises:{get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(n){return this.promises.push(n),n},cancelPromises:function(){var n=this;if(n.promises)for(var e=0;e<n.promises.length;e++)n.promises[e]&&n.promises[e].cancel()}}],e.define=t,e.fragmentMixin=r,e.renderFragment=o}(t=e.Pages||(e.Pages={}))}(e=n.UI||(n.UI={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(n){var e;!function(e){function t(n,e){for(var t=0,r=0,i=n.clientWidth,o=n.clientHeight;n&&n!=e;)t+=n.offsetLeft-n.scrollLeft+n.clientLeft,r+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;return{x:t,y:r,width:i,height:o}}function r(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var e=0;e<n.length;e++){var t=n[e];t.winControl&&t.winControl.show()}}function i(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var e=0;e<n.length;e++){var t=n[e];t.winControl&&t.winControl.hide()}}function o(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var e=0;e<n.length;e++){var t=n[e];t.winControl&&(t.winControl.disabled=!0)}}function a(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var e=0,t=n.length;t>e;e++){var r=n[e];r.winControl&&(r.winControl.disabled=!1)}}function s(n,e){return new WinJS.Promise(function(t,r){function i(){n.onload=void 0,n.onerror=void 0,n.onreadystatechange=void 0,r("element not loaded")}function o(){n.onload=void 0,n.onerror=void 0,n.onreadystatechange=void 0,t({element:n,url:e})}n.onerror=i,n.onload=o,n.onreadystatechange=o,n.naturalWidth>0&&o(void 0),n.src=e})}function c(n){return new WinJS.Promise(function(e,t){function r(){o.onload=void 0,o.onerror=void 0,t({message:"image not loaded : "+n,path:n})}function i(){o.onload=void 0,o.onerror=void 0,e({element:o,url:n})}var o=new Image;o.onerror=r,o.onload=i,o.naturalWidth>0&&i(void 0),o.src=n})}function u(n){var e=[],t=!1;if(n.parentElement)for(var r=n.parentElement,i=0;i<r.children.length;i++)r.children[i]===n?t=!0:t&&e.push(r.children[i]);return e}function p(e){return new WinJS.Promise(function(t){var r=n.UI.listElementsAfterMe(e),i=WinJS.UI.Animation.createDeleteFromListAnimation([e],r);e.style.position="fixed",e.style.opacity="0",i.execute().done(function(){t(e)})})}function l(e,t,r){e.classList.add("page-action");var i=e.dataset.pageAction,o=r[i];o&&"function"==typeof o&&n.UI.tap(e,function(e){var t=e.dataset.pageActionArgs;if(t&&"string"==typeof t)try{var o=n.Utils.readValue(e,t);t=o?o:JSON.parse(t)}catch(a){return}r[i].bind(r)({elt:e,args:t})})}function f(n,e){var t=n.querySelectorAll("*[data-page-action]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];l(o,n,e)}}function d(e){e.classList.add("page-link");var t=e.dataset.pageLink;if(t&&t.indexOf("/")<0){var r=n.Utils.readProperty(window,t);r&&(t=r)}t&&n.UI.tap(e,function(e){var r=e.dataset.pageActionArgs;if(r&&"string"==typeof r)try{var i=n.Utils.readValue(e,r);r=i?i:JSON.parse(r)}catch(o){return}if(n.UI.parentNavigator&&n.UI.parentNavigator(e)){var a=n.UI.parentNavigator(e);a.navigate(t,r)}else WinJS.Navigation.navigate(t,r)})}function v(n){var e=n.querySelectorAll("*[data-page-link]");if(e&&e.length)for(var t=0,r=e.length;r>t;t++){var i=e[t];d(i,n)}}function m(n){for(var e=n.parentNode;e;){if(e.mcnNavigator)return e.winControl;e=e.parentNode}}function h(n,e,t){n.classList.add("page-member");var r=n.dataset.pageMember;r||(r=n.id),r&&!t[r]&&(t[r]=n,n.winControl&&(t[r]=n.winControl))}function g(n,e){var t=n.querySelectorAll("*[data-page-member]");if(t&&t.length)for(var r=0,i=t.length;i>r;r++){var o=t[r];h(o,n,e)}}function y(e,t){n.UI.bindPageActions(e,t),n.UI.bindPageLinks(e)}function w(e,t){function r(n){var e=new WinJS.Promise(function(){});n.detail.setPromise(e),e.cancel()}var i=[];e.navLocks=e.navLocks||[],e.navLocks.isActive=!0;for(var o=function(n){e.navLocks&&0!==e.navLocks.length||t.bind(e)(n)},a=document.querySelectorAll(".mcn-navigation-ctrl"),s=0;s<a.length;s++){var c=a[s].winControl;c&&c!=e&&(c.navLocks=c.navLocks||[],c.navLocks.isActive&&(!c.navLocks.length||c.navLocks.indexOf(e)<0)&&(c.navLocks.push(e),i.push(c)))}return WinJS.Navigation.addEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone?window.Windows.Phone.UI.Input.HardwareButtons.addEventListener("backpressed",o):document.addEventListener("backbutton",o),n.UI.Application&&n.UI.Application.navigator&&n.UI.Application.navigator.addLock(),function(){n.UI.Application&&n.UI.Application.navigator&&n.UI.Application.navigator.removeLock(),e.navLocks.isActive=!1,i.forEach(function(n){var t=n.navLocks.indexOf(e);t>=0&&n.navLocks.splice(t,1)}),WinJS.Navigation.removeEventListener("beforenavigate",r),window.Windows&&window.Windows.Phone?window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener("backpressed",o):document.removeEventListener("backbutton",o)}}function T(n){n.mcnTapTracking&&(n.mcnTapTracking.dispose(),n.mcnTapTracking=null)}function P(n){for(var e=n.querySelectorAll(".tap"),t=0,r=e.length;r>t;t++)T(e[t])}function k(e,t,r){var i=function(n){var e=n.currentTarget||n.target,t=e.mcnTapTracking;t&&(void 0===n.button||0===n.button||t.allowRickClickTap&&2===n.button)&&(t.lock&&(n.pointerId&&n.currentTarget.setPointerCapture&&n.currentTarget.setPointerCapture(n.pointerId),n.stopPropagation(),n.preventDefault()),n.currentTarget.classList.add("tapped"),t.pointerdown=n.changedTouches?{x:n.changedTouches[0].clientX,y:n.changedTouches[0].clientY}:{x:n.clientX,y:n.clientY},t.animDown(n.currentTarget),t.tapOnDown&&t.callback(e))},o=function(n){var e=n.currentTarget||n.target,t=e.mcnTapTracking;t&&t.pointerdown&&(e.classList.remove("tapped"),n.pointerId&&e.releasePointerCapture&&e.releasePointerCapture(n.pointerId),t.disableAnimation||t.animUp(n.currentTarget))},a=function(n){var e=n.currentTarget||n.target,t=e.mcnTapTracking;if(t&&(void 0===n.button||0===n.button||t.allowRickClickTap&&2===n.button)){if(e.releasePointerCapture&&e.releasePointerCapture(n.pointerId),t&&!t.tapOnDown){n.stopPropagation();var r=function(){if(t&&t.pointerdown){if(n.changedTouches)var r=Math.abs(t.pointerdown.x-n.changedTouches[0].clientX),i=Math.abs(t.pointerdown.y-n.changedTouches[0].clientY);else var r=Math.abs(t.pointerdown.x-n.clientX),i=Math.abs(t.pointerdown.y-n.clientY);t.callback&&15>r&&15>i&&(n.stopImmediatePropagation(),n.stopPropagation(),n.preventDefault(),t.callback(e)),t&&t.pointerdown&&(t.pointerdown=void 0)}};t.awaitAnim?t.animUp(e).done(r):(t.animUp(e),r())}e.classList.remove("tapped")}},s=r||{};e.mcnTapTracking&&e.mcnTapTracking.dispose(),e.classList&&e.classList.add("tap"),e.mcnTapTracking=e.mcnTapTracking||{},e.mcnTapTracking.eventTracker=new n.UI.EventTracker,e.mcnTapTracking.disableAnimation=s.disableAnimation,e.mcnTapTracking.disableAnimation?(e.mcnTapTracking.animDown=function(){return WinJS.Promise.wrap()},e.mcnTapTracking.animUp=function(){return WinJS.Promise.wrap()}):(e.mcnTapTracking.animDown=s.animDown||WinJS.UI.Animation.pointerDown,e.mcnTapTracking.animUp=s.animUp||WinJS.UI.Animation.pointerUp),e.mcnTapTracking.element=e,e.mcnTapTracking.callback=t,e.mcnTapTracking.lock=s.lock,e.mcnTapTracking.awaitAnim=s.awaitAnim||!1,e.mcnTapTracking.disableAnimation=s.disableAnimation,e.mcnTapTracking.tapOnDown=s.tapOnDown,e.mcnTapTracking.pointerModel="none",e.mcnTapTracking.dispose=function(){e.classList&&e.classList.remove("tap"),this.eventTracker.dispose(),e.mcnTapTracking=null,e=null},void 0!==e.onpointerdown?(e.mcnTapTracking.pointerModel="pointers",e.mcnTapTracking.eventTracker.addEvent(e,"pointerdown",i),e.mcnTapTracking.eventTracker.addEvent(e,"pointerout",o),e.mcnTapTracking.eventTracker.addEvent(e,"pointerup",a)):window.Touch&&!s.noWebkitTouch?(e.mcnTapTracking.pointerModel="touch",e.mcnTapTracking.eventTracker.addEvent(e,"touchstart",i),e.mcnTapTracking.eventTracker.addEvent(e,"touchcancel",o),e.mcnTapTracking.eventTracker.addEvent(e,"touchend",a)):(e.mcnTapTracking.pointerModel="mouse",e.mcnTapTracking.eventTracker.addEvent(e,"mousedown",i),e.mcnTapTracking.eventTracker.addEvent(e,"mouseleave",o),e.mcnTapTracking.eventTracker.addEvent(e,"mouseup",a))}function S(n,e){var t=null;return new WinJS.Promise(function(r){var i=function(e){e.srcElement===n&&o()},o=function(){clearTimeout(t),n.removeEventListener("transitionend",i,!1),r()};n.addEventListener("transitionend",i,!1),t=setTimeout(o,e||1e3)})}e.Application={},e.disableAutoResources=!1,e.offsetFrom=t;var b=function(){function n(){this.events=[]}return n.prototype.addEvent=function(n,e,t,r){var i=this;n.addEventListener(e,t,r);var o=function(){try{n.removeEventListener(e,t);var r=i.events.indexOf(o);r>=0&&i.events.splice(r,1)}catch(a){console.error("unexpected error while releasing callback "+a.message)}};return this.events.push(o),o},n.prototype.addBinding=function(n,e,t){n.bind(e,t);var r=function(){n.unbind(e,t)};return this.events.push(r),r},n.prototype.dispose=function(){for(var n=0;n<this.events.length;n++)this.events[n]();this.events=[]},n}();e.EventTracker=b,e.appbarsOpen=r,e.appbarsClose=i,e.appbarsDisable=o,e.appbarsEnable=a,e.elementLoaded=s,e.loadImage=c,e.listElementsAfterMe=u,e.removeElementAnimation=p,e.bindPageActions=f,e.bindPageLinks=v,e.parentNavigator=m,e.bindMembers=g,e.bindActions=y;var W=function(){function n(n,e){var t=this;t.queries=[],t.linkedControl=e;for(var r in n){var i=n[r];i.query&&t.registerMediaEvent(r,i.query,i)}}return n.prototype.dispose=function(){var n=this;n.linkedControl=null,this.queries.forEach(function(n){n.dispose()})},n.prototype.registerMediaEvent=function(n,e,t){var r=this,i=window.matchMedia(e),o={name:n,query:e,data:t,mq:i,dispose:null},a=function(n){n.matches&&r._mediaEvent(n,o)};i.addListener(a),o.dispose=function(){i.removeListener(a)},r.queries.push(o)},n.prototype._mediaEvent=function(n,e){var t=this;t.linkedControl&&WinJS.UI.setOptions(t.linkedControl,e.data),t.dispatchEvent("media",e)},n.prototype.check=function(){var n=this;n.queries.forEach(function(e){var t=window.matchMedia(e.query);t.matches&&n._mediaEvent({matches:!0},e)})},n.prototype.addEventListener=function(){},n.prototype.dispatchEvent=function(){return!1},n.prototype.removeEventListener=function(){},n}();e.MediaTrigger=W,WinJS.Class.mix(n.UI.MediaTrigger,WinJS.Utilities.eventMixin),e.registerNavigationEvents=w,e.untap=T,e.untapAll=P,e.tap=k,e.afterTransition=S;var U=function(){function e(n,e){this.element=document.createElement(n),this.parent=e,this.childs=[],e&&e.childs.push(this)}return Object.defineProperty(e.prototype,"control",{get:function(){return this.element.winControl},enumerable:!0,configurable:!0}),e.prototype.addClass=function(n){return this.element.classList.add(n),this},e.prototype.className=function(n){return this.element.className=n,this},e.prototype.opacity=function(n){return this.element.style.opacity=n,this},e.prototype.display=function(n){return this.element.style.display=n,this},e.prototype.hide=function(){return this.element.style.display="none",this},e.prototype.visibility=function(n){return this.element.style.visibility=n,this},e.prototype.text=function(n){return this.element.innerText=n,this},e.prototype.html=function(n){return this.element.innerHTML=n,this},e.prototype.attr=function(n,e){return this.element.setAttribute(n,e),this},e.prototype.appendTo=function(n){return n.appendChild(this.element),this},e.prototype.tap=function(e,t){return n.UI.tap(this.element,e,t),this},e.prototype.append=function(n,t){var r=new e(n,this);return this.element.appendChild(r.element),t&&t(r),this},e.prototype.ctrl=function(e,t){var r=e;return"string"==typeof e&&(r=n.Utils.readProperty(window,e)),r&&new r(this.element,t),this},e}();e.FluentDOM=U}(e=n.UI||(n.UI={}))}(WinJSContrib||(WinJSContrib={})),Object.map||(Object.map=function(n,e){var t={};return"object"!=typeof n?t:("function"!=typeof e&&(e=function(n,e){return[n,e]}),Object.keys(n).forEach(function(r){var i=e.apply(n,[r,n[r]]);i&&i.length&&(t[i[0]||r]=i[1])}),t)}),String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(e,t){return"undefined"!=typeof n[t]?n[t]:e})}),String.prototype.padLeft||(String.prototype.padLeft=function(n,e){return void 0===e&&(e="0"),this.length<n?(e+this).padLeft(n,e):this});var WinJSContrib;!function(n){var e;!function(n){function e(n,e){var t=WinJS.Promise.wrap(),r=[];if(!n)return WinJS.Promise.wrap([]);var i=WinJS.Promise.as(n);return i.then(function(n){var i=function(n,t){return n.then(function(){return WinJS.Promise.as(e(t)).then(function(n){r.push(n)})})};return n.forEach(function(n){t=i(t,n)}),t.then(function(){return r})})}function t(n,e){if(!n)return WinJS.Promise.wrap([]);var t=WinJS.Promise.as(n);return t.then(function(n){var t=[];return n.forEach(function(n){t.push(WinJS.Promise.as(e(n)))}),WinJS.Promise.join(t)})}function r(n,e,t){if(!n)return WinJS.Promise.wrap([]);var r=WinJS.Promise.as(n);return r.then(function(n){var r=WinJS.Promise.wrap(),i=[],o=[],a=!1,s=function(n,e){return n.then(function(){return WinJS.Promise.join(e.map(function(n){return WinJS.Promise.as(t(n))})).then(function(n){n=n.concat(n)},function(n){o=o.concat(n),a=!0})})};return n.forEach(function(n,t){i.push(n),t>0&&t%e===0&&(r=s(r,i),i=[])}),i.length&&(r=s(r,i)),r.then(function(){return a?WinJS.Promise.wrapError(o):o})})}n.waterfall=e,n.parallel=t,n.batch=r}(e=n.Promise||(n.Promise={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(n){var e;!function(e){function t(){for(var n=1;n<arguments.length;n++)for(var e in arguments[n])arguments[n].hasOwnProperty(e)&&(arguments[0][e]=arguments[n][e]);return arguments[0]}function r(n,e){if(!e)return!1;var t=n.match("^"+e)==e;return t}function i(n,e){return e?n.match(e+"$")==e:!1}function o(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var i=encodeURIComponent(r),o=e[r],a=n.Utils.hasValue(o)?encodeURIComponent(o):"";t.push(i+"="+a)}return t.join("&")}function a(n,e,t,r){var i=document.createEvent("Event");i.initEvent(e,t,r),n.dispatchEvent(i)}function s(n,e,t,r,i){var o=document.createEvent("CustomEvent");o.initCustomEvent(e,t,r,i),n.dispatchEvent(o)}function c(n,e){if(n){if("this"===e)return n;var t=n[e];if("undefined"!=typeof t)return t;var r=e.indexOf("[");if(!(0>r)){var i=e.indexOf("]",r);if(!(0>i)){var o=e.substr(r+1,i-r);return o=parseInt(o),n[o]}}}}function u(e,t,r){if(n.Utils.hasValue(t))return e.setProperty?void e.setProperty(t,r):void(e[t]=r);if("string"==typeof t){var i=t.indexOf("[");if(0>i)return;var o=t.indexOf("]",i);if(0>o)return;var a=t.substr(i+1,o-i);a=parseInt(a),e[a]=r}}function p(e,t){if("string"==typeof t&&e[t])return e[t];if(!t||!t.length)return e;var r=n.Utils.getProperty(e,t);return r?r.propValue:void 0}function l(n,e){"string"==typeof e&&(e=e.split(".")),e&&e.length||(e=["this"]);for(var t=n,r=null,i=0;i<e.length;i++){var o=new M(t,r,e[i]);if(r=o,i==e.length-1)return o;t=c(t,e[i])}}function f(e,t,r){var i=n.Utils.getProperty(e,t);i&&(i.propValue=r)}function d(n,e){return Math.random()*(e-n+1)+n<<0}function v(n,e){return n>e?1:e>n?-1:0}function m(e,t,r){if(null===e||0===e.length)return e;"undefined"==typeof r&&(r=!1);var i,o,a="",s=0,c=[];if(r)for(o=0;o<e.length;o++){if(t){var u=n.Utils.readProperty(e[o],t.split("."));i=u,u||(i=u),u&&u.toLowerCase&&(i=u.toLowerCase())}else i=e[o];a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=e[o])}else for(o=0;o<e.length;o++)i=t?n.Utils.readProperty(e[o],t.split(".")):e[o],a.indexOf("|"+i+"|")<0&&(a+="|"+i+"|",c[s++]=e[o]);return c}function h(t,r,i){return e.distinctArray(t,r,i).map(function(e){return n.Utils.readProperty(e,r.split("."))})}function g(n){var e=n.toLowerCase();return e=e.replace(new RegExp("[àáâãäå]","g"),"a"),e=e.replace(new RegExp("æ","g"),"ae"),e=e.replace(new RegExp("ç","g"),"c"),e=e.replace(new RegExp("[èéêë]","g"),"e"),e=e.replace(new RegExp("[ìíîï]","g"),"i"),e=e.replace(new RegExp("ñ","g"),"n"),e=e.replace(new RegExp("[òóôõö]","g"),"o"),e=e.replace(new RegExp("œ","g"),"oe"),e=e.replace(new RegExp("[ùúûü]","g"),"u"),e=e.replace(new RegExp("[ýÿ]","g"),"y")}function y(n){var e=[];WinJS.Navigation.history&&WinJS.Navigation.history.backStack&&WinJS.Navigation.history.backStack.length&&WinJS.Navigation.history.backStack.forEach(function(t){t.location!==n&&e.push(t)}),WinJS.Navigation.history.backStack=e}function w(n){return(10>n?"0":"")+n}function T(n,e,t){if(!n)return"";var r=n.length>e,i=r?n.substr(0,e-1):n;return i=t&&r?i.substr(0,i.lastIndexOf(" ")):i,r?i+"...":i}function P(){var n=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:7&t|8).toString(16)});return e}function k(n,e){if(n&&n.parentElement)for(var t=n.parentElement;t;){if(t.winControl&&void 0!==t.winControl[e])return t.winControl[e];t=t.parentElement}}function S(n,e){for(var t=[],r=0;r<n.children.length;r++)t.push(n.children[r]);t.forEach(function(n){e.appendChild(n)})}function b(n,e){for(var t=e.parentNode;t;){if(t[n]&&t.winControl)return t.winControl;t=t.parentNode}}function W(n,e){for(var t=e.parentNode;t;){if(t.classList&&t.classList.contains(n)&&t.winControl)return t.winControl;t=t.parentNode}}function U(e){return n.Utils.getParent("mcnPage",e)}function C(n){for(var e=n.parentNode;e;){if(e.msParentSelectorScope){var t=e.parentNode;if(t){var r=t.winControl;if(r)return r}}e=e.parentNode}}function J(n){if(n){var e=typeof n;if("string"==e)return new WinJS.Binding.Template(null,{href:n});if("function"==e)return{render:function(e,t){var r=n(e,t);return WinJS.Promise.as(r)}};if(n.winControl)return n.winControl;if(n.render)return n}}function E(e,t){var r=n.Utils.resolveValue(e,t);return r&&"function"==typeof r?r:void 0}function x(e,t){var r=n.Utils.resolveValue(e,t);return r?"function"==typeof r?r(e):r:void 0}function A(e,t){var r,i,o;if(0===t.indexOf("page:")){if(r=t.substr(5),n.Utils.getParentPage&&(i=n.Utils.getParentPage(e)),!i&&n.UI.Application.navigator&&(i=n.UI.Application.navigator.pageControl),!i)return;o=n.Utils.readProperty(i,r),o&&"function"==typeof o&&(o=o.bind(i))}else 0===t.indexOf("ctrl:")?(r=t.substr(5),i=n.Utils.getScopeControl(e),o=n.Utils.readProperty(i,r),o&&"function"==typeof o&&(o=o.bind(i))):(r=t,i=n.Utils.getScopeControl(e),o=n.Utils.readProperty(window,r));return o}function L(n){return"undefined"!=typeof n&&null!==n}function I(n){return"{0} - {1}: {2}".format(n.status,n.statusText,n.responseText)}function _(n){return function(e){for(var t=null,r=0;r<e.length;r++){var i=e[r];if("undefined"!=typeof i){t=i;break}}return n(t)}}function D(n,e){if(e)for(var t in e)n[t]=e[t]}e.extend=t,e.startsWith=r,String.prototype.startsWith||(String.prototype.startsWith=function(e){return n.Utils.startsWith(this,e)}),e.endsWith=i,String.prototype.endsWith||(String.prototype.endsWith=function(e){return n.Utils.endsWith(this,e)}),e.queryStringFrom=o,e.triggerEvent=a,e.triggerCustomEvent=s,e.readProperty=p;var M=function(){function n(n,e,t){this.parent=n,this.parentDescriptor=e,this.keyProp=t}return n.prototype.ensureParent=function(){return parent?parent:void(this.parentDescriptor&&(this.parentDescriptor.ensureParent(),this.parentDescriptor.parent[this.parentDescriptor.keyProp]||(this.parentDescriptor.parent[this.parentDescriptor.keyProp]={},this.parent=this.parentDescriptor.parent[this.parentDescriptor.keyProp])))},Object.defineProperty(n.prototype,"propValue",{get:function(){return c(this.parent,this.keyProp)},set:function(n){this.ensureParent(),u(this.parent,this.keyProp,n)},enumerable:!0,configurable:!0}),n}();e.PropertyDescriptor=M,e.getProperty=l,e.writeProperty=f,e.randomFromInterval=d,e.alphabeticSort=v,e.distinctArray=m,e.getDistinctPropertyValues=h,e.removeAccents=g,e.removePageFromHistory=y,e.pad2=w,e.ellipsisizeString=T,e.guid=P,e.inherit=k,e.moveChilds=S,e.getParent=b,e.getParentControlByClass=W,e.getParentPage=U,e.getScopeControl=C,e.getTemplate=J,e.resolveMethod=E,e.readValue=x,e.resolveValue=A,e.hasValue=L,e.formatXHRError=I,e.unwrapJoinError=_,e.inject=D}(e=n.Utils||(n.Utils={}))}(WinJSContrib||(WinJSContrib={}));var WinJSContrib;!function(n){var e;!function(e){function t(n){var e=o[n];return o[n]?e:new WinJS.Binding.Template(null,{href:n})}function r(e,t){var r=n.Templates.get(e);if(r)return n.Templates.makeInteractive(r,t);throw{message:"template not found for "+e}}function i(e,t){return function(r){return r.then(function(r){return e.render(r).then(function(e){if(t.tap)for(var i in t.tap){var o=e.querySelector(i);n.UI.tap(o,function(n){t.tap[i](n,r)})}if(t.click)for(var i in t.click){var o=e.querySelector(i);o.onclick=function(n){t.click[i](n,r)}}return e})})}}var o={};e.get=t,e.interactive=r,e.makeInteractive=i}(e=n.Templates||(n.Templates={}))}(WinJSContrib||(WinJSContrib={}));