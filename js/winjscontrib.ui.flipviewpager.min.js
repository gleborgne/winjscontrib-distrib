/* 
 * WinJS Contrib v2.1.0.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{FlipViewPager:WinJS.Class.mix(WinJS.Class.define(function(i,e){this.element=i||document.createElement("DIV"),e=e||{},this.element.className="mcn-flipviewpager",this.element.winControl=this,this.element.classList.add("win-disposable"),this.isFlipping=!1,this.flipviewPagerContextGroup=e.flipviewPagerContextGroupName||"flipviewPagerContextGroup",this.flipviewPageVisibilityChangeBinded=this.flipviewPageVisibilityChange.bind(this),this.pageSelectedBinded=this.pageSelected.bind(this),this.countChangedBinded=this.countChanged.bind(this),WinJS.UI.setOptions(this,e)},{flipView:{get:function(){return this._flipView},set:function(i){this.unregisterFlipViewEvents(),i?(this._flipView=i,i.winControl&&(this._flipView=i.winControl),this.registerFlipViewEvents(),this.initControl()):this._flipView=void 0}},initControl:function(){var i=this;this._flipView.count().done(function(e){i.initButtons(e)})},buttonClicked:function(i){if(this._flipView)if(this.isFlipping){var e=this._flipView.currentPage;this.radioButtons[e].checked=!0}else{var t=i.srcElement.getAttribute("value");this._flipView.currentPage=parseInt(t,10)}},countChanged:function(){this.initControl()},pageChange:function(){var i=this._flipView.currentPage,e=this.radioButtons[i];e?e.checked=!0:this.initControl()},pageSelected:function(){this.isFlipping=!1,this.pageChange()},flipviewPageVisibilityChange:function(i){i.detail.visible===!0&&(this.isFlipping=!0),this.pageChange()},registerFlipViewEvents:function(){this._flipView&&(this._flipView.addEventListener("pagevisibilitychanged",this.flipviewPageVisibilityChangeBinded,!1),this._flipView.addEventListener("pageselected",this.pageSelectedBinded,!1),this._flipView.addEventListener("datasourcecountchanged",this.countChangedBinded,!1))},unregisterFlipViewEvents:function(){this._flipView&&(this._flipView.removeEventListener("pagevisibilitychanged",this.flipviewPageVisibilityChangeBinded),this._flipView.removeEventListener("pageselected",this.pageSelectedBinded),this._flipView.removeEventListener("datasourcecountchanged",this.countChangedBinded))},initButtons:function(i){var e=this;this.radioButtons=[],this.element.innerHTML="";for(var t=0;i>t;++t){var n=document.createElement("input");n.setAttribute("type","radio"),n.setAttribute("name",e.flipviewPagerContextGroup),n.setAttribute("value",t),n.setAttribute("aria-label",t+1+" of "+i),n.onclick=this.buttonClicked.bind(this),this.radioButtons.push(n),this.element.appendChild(n)}i>0&&(this.radioButtons[this._flipView.currentPage].checked=!0)},dispose:function(){this.unregisterFlipViewEvents(),WinJS.Utilities.disposeSubTree(this.element)}}),WinJS.UI.DOMEventMixin)})}();