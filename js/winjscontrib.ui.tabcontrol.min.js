/* 
 * WinJS Contrib v2.0.3.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{TabPages:WinJS.Class.define(function(e,t){var a=this;t=t||{},a.element=e||document.createElement("div"),a.element.className="mcn-tabpages "+a.element.className,WinJSContrib.CrossPlatform&&WinJSContrib.CrossPlatform.crossPlatformClass&&WinJSContrib.CrossPlatform.crossPlatformClass(a.element),a.tabHeader=t.header||e.querySelector(".mcn-tabpages-header"),a.tabHeaderTemplate=t.headerTemplate,a.tabContent=t.content||e.querySelector(".mcn-tabpages-content"),a.tabLinkUri=t.uri,a.tabLinkArgs=t.args,a.tabs={"default":[]},a.tabContent||(a.tabContent=document.createElement("DIV"),a.tabContent.className="mcn-tabpages-content",a.element.appendChild(a.tabContent)),a.tabWrapper=document.createElement("DIV"),a.tabWrapper.className="mcn-tabpages-content-wrapper",a.tabContent.appendChild(a.tabWrapper),a.navigator=new WinJSContrib.UI.PageControlNavigator(a.tabWrapper,{global:!1,delay:10,disableHistory:!0}),a.navigator.animationWaitForPreviousPageClose=!1,a.navigator.animations.exitPage=WinJSContrib.UI.Animation.tabExitPage,a.navigator.animations.enterPage=WinJSContrib.UI.Animation.tabEnterPage,a.tabHeader||(a.tabHeader=document.createElement("DIV"),a.tabHeader.className="mcn-tabpages-header",a.element.appendChild(a.tabHeader)),a._createGroupHeader("default"),t.registerTabs&&a.registerTabs(),t.swipeSlide&&WinJSContrib.UI.SwipeSlide&&a.setSwipeSlideOnDefaultTab(t.rightbar)},{_createGroupHeader:function(e){var t=this;if(!t.tabs[e]||!t.tabs[e].tabGroup){var a=document.createElement("DIV");a.className="header-group-"+e+" mcn-tabpages-headergroup",t.tabs[e]||(t.tabs[e]=[]),t.tabs[e].tabGroup=a,t.tabHeader.appendChild(a)}},setSwipeRightbar:function(){var e=this;e.left="right",e.right="left"},setSwipeSlideOnDefaultTab:function(e){var t=this;e?t.setSwipeRightbar():(t.left="left",t.right="right"),t.swipeSlide=new WinJSContrib.UI.SwipeSlide(t.tabWrapper),t.navigator.animations.exitPage=function(e){return WinJSContrib.UI.Animation.fadeOut(e,{duration:100})},t.swipeSlide.onswipe=function(e){var a=t.swipeSlide.target.style;if(a.hasOwnProperty("webkitTransform")&&console.log("running on webkit"),t.swipeSlide.swipeHandled=!0,t.currentTab&&t.navigator.pageElement){var n=t.navigator.pageElement;n.style.transform=a.transform,a.hasOwnProperty("webkitTransform")&&(n.style.webkitTransform=a.webkitTransform,a.webkitTransform=""),a.transform="","left"==e.detail.direction?(n.winControl.getAnimationElements=function(){return null},WinJSContrib.UI.Animation.slideToLeft(n)):"right"==e.detail.direction&&(n.winControl.getAnimationElements=function(){return null},WinJSContrib.UI.Animation.slideToRight(n))}a.transform="",a.hasOwnProperty("webkitTransform")&&(a.webkitTransform=""),null==t.currentTab?t.selectFirst():"right"==e.detail.direction?(t.navigator.animations.enterPage=function(){return WinJSContrib.UI.Animation.slideFromLeft(t.tabWrapper)},t.selectByIndex(0==t.currentTab.index?t.tabs["default"].length-1:t.currentTab.index-1)):"left"==e.detail.direction&&(t.navigator.animations.enterPage=function(){return WinJSContrib.UI.Animation.slideFromRight(t.tabWrapper)},t.selectByIndex(t.currentTab.index==t.tabs["default"].length-1?0:t.currentTab.index+1))}},getPageLinkArgs:function(e){var t=this;return e.link.args||t.tabLinkArgs},getPageLink:function(e){var t=this;return e.link.uri||t.tabLinkUri?{uri:e.link.uri||t.tabLinkUri,args:t.getPageLinkArgs(e)}:void 0},selectFirst:function(e){this.selectTab(this.tabs["default"][0],e)},selectTab:function(e,t,a){var n=this;if(e!=n.currentTab){var r=n.getPageLink(e);if(r){var i=$.extend({},a,r.args);n.navigator.open(r.uri,i),n.currentTab=e;var o=n.tabHeader.querySelector(".mcn-tabpages-headeritem.current");o&&WinJS.Utilities.removeClass(o,"current"),t||n.selectTabHeader()}}},selectTabHeader:function(){var e=this;e.currentTab&&WinJS.Utilities.addClass(e.currentTab.element,"current")},selectByIndex:function(e,t,a,n){var r=this,i=r.tabs[a||"default"],o=i[e];o&&r.selectTab(o,t,n)},selectByName:function(e,t,a,n){for(var r=this,i=r.tabs[a||"default"],o=0;o<i.length;o++){var s=i[o];if(s.item&&(s.item.id===e||s.item.name===e)){r.selectTab(s,t,n);break}}},selectByItem:function(e,t,a,n){for(var r=this,i=r.tabs[a||"default"],o=0;o<i.length;o++){var s=i[o];if(s.item==e){r.selectTab(s,t,n);break}}},registerTabs:function(e,t){var a=this,n=a.tabs[t||"default"];n||(a._createGroupHeader(t),n=a.tabs[t]);for(var r=a.element.querySelectorAll(".mcn-tabpages-headeritem"),i=0;i<r.length;i++){var o=r[i];!function(e){var r={element:e,link:{uri:e.getAttribute("data-tabtarget")}};e.mcnTab=r,n.tabGroup.appendChild(e),r.index=n.length,r.group=t,n.push(r),WinJSContrib.UI.tap(r.element,function(){a.selectTab(r)})}(o)}},addTab:function(e,t){this.addTabs([e],t)},addTabs:function(e,t){var a=this,n=a.tabs[t||"default"];n||(a._createGroupHeader(t),n=a.tabs[t]);var r=n.tabGroup,i=a.tabHeaderTemplate;i&&(i=WinJSContrib.Utils.getTemplate(i)),e.forEach(function(e){var o=document.createElement("DIV");o.className="mcn-tabpages-headeritem",r.appendChild(o);var s={element:o,item:e,link:{uri:e.uri||e.href||a.tabLinkUri,args:e.args||null,oninvoked:e.invoked}};o.mcnTab=s,s.index=n.length,s.group=t,n.push(s),WinJSContrib.UI.tap(o,function(){s.link.oninvoked?s.link.oninvoked(a,s):a.selectTab(s)}),i.render(e).done(function(e){for(;e.children.length>0;)o.appendChild(e.children[0])})})}})})}();