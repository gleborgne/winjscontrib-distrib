/* 
 * WinJS Contrib v2.0.1.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{TabPages:WinJS.Class.define(function(e,t){var n=this;t=t||{},n.element=e||document.createElement("div"),n.element.className="mcn-tabpages "+n.element.className,WinJSContrib.CrossPlatform&&WinJSContrib.CrossPlatform.crossPlatformClass&&WinJSContrib.CrossPlatform.crossPlatformClass(n.element),n.tabHeader=t.header||e.querySelector(".mcn-tabpages-header"),n.tabHeaderTemplate=t.headerTemplate,n.tabContent=t.content||e.querySelector(".mcn-tabpages-content"),n.tabLinkUri=t.uri,n.tabLinkArgs=t.args,n.tabs={"default":[]},n.tabContent||(n.tabContent=document.createElement("DIV"),n.tabContent.className="mcn-tabpages-content",n.element.appendChild(n.tabContent)),n.navigator=new WinJSContrib.UI.PageControlNavigator(n.tabContent,{global:!1,delay:10,disableHistory:!0}),n.navigator.animationWaitForPreviousPageClose=!1,n.navigator.animations.exitPage=WinJSContrib.UI.Animation.tabExitPage,n.navigator.animations.enterPage=WinJSContrib.UI.Animation.tabEnterPage,n.tabHeader||(n.tabHeader=document.createElement("DIV"),n.tabHeader.className="mcn-tabpages-header",n.element.appendChild(n.tabHeader)),n._createGroupHeader("default"),t.registerTabs&&n.registerTabs(),t.swipeSlide&&WinJSContrib.UI.SwipeSlide&&n.setSwipeSlideOnDefaultTab(t.rightbar)},{_createGroupHeader:function(e){var t=this;if(!t.tabs[e]||!t.tabs[e].tabGroup){var n=document.createElement("DIV");n.className="header-group-"+e+" mcn-tabpages-headergroup",t.tabs[e]||(t.tabs[e]=[]),t.tabs[e].tabGroup=n,t.tabHeader.appendChild(n)}},setSwipeRightbar:function(){var e=this;e.left="right",e.right="left"},setSwipeSlideOnDefaultTab:function(e){var t=this;e?t.setSwipeRightbar():(t.left="left",t.right="right"),t.swipeSlide=new WinJSContrib.UI.SwipeSlide(t.tabContent),t.navigator.animations.exitPage=function(e){return WinJSContrib.UI.Animation.fadeOut(e,{duration:100})},t.swipeSlide.onswipe=function(e){var n=t.swipeSlide.target.style;if(n.hasOwnProperty("webkitTransform")&&console.log("running on webkit"),t.swipeSlide.swipeHandled=!0,t.currentTab&&t.navigator.pageElement){var a=t.navigator.pageElement;a.style.transform=n.transform,n.hasOwnProperty("webkitTransform")&&(a.style.webkitTransform=n.webkitTransform,n.webkitTransform=""),n.transform="","left"==e.detail.direction?(a.winControl.getAnimationElements=function(){return null},WinJSContrib.UI.Animation.slideToLeft(a)):"right"==e.detail.direction&&(a.winControl.getAnimationElements=function(){return null},WinJSContrib.UI.Animation.slideToRight(a))}n.transform="",n.hasOwnProperty("webkitTransform")&&(n.webkitTransform=""),null==t.currentTab?t.selectFirst():"right"==e.detail.direction?(t.navigator.animations.enterPage=function(){return WinJSContrib.UI.Animation.slideFromLeft(t.tabContent)},t.selectByIndex(0==t.currentTab.index?t.tabs["default"].length-1:t.currentTab.index-1)):"left"==e.detail.direction&&(t.navigator.animations.enterPage=function(){return WinJSContrib.UI.Animation.slideFromRight(t.tabContent)},t.selectByIndex(t.currentTab.index==t.tabs["default"].length-1?0:t.currentTab.index+1))}},getPageLinkArgs:function(e){var t=this;return e.link.args||t.tabLinkArgs},getPageLink:function(e){var t=this;return e.link.uri||t.tabLinkUri?{uri:e.link.uri||t.tabLinkUri,args:t.getPageLinkArgs(e)}:void 0},selectFirst:function(e){this.selectTab(this.tabs["default"][0],e)},selectTab:function(e,t){var n=this;if(e!=n.currentTab){var a=n.getPageLink(e);if(a){n.navigator.open(a.uri,a.args),n.currentTab=e;var i=n.tabHeader.querySelector(".mcn-tabpages-headeritem.current");i&&WinJS.Utilities.removeClass(i,"current"),t||n.selectTabHeader()}}},selectTabHeader:function(){var e=this;e.currentTab&&WinJS.Utilities.addClass(e.currentTab.element,"current")},selectByIndex:function(e,t,n){var a=this,i=a.tabs[n||"default"],r=i[e];r&&a.selectTab(r,t)},selectByItem:function(e,t,n){for(var a=this,i=a.tabs[n||"default"],r=0;r<i.length;r++){var o=i[r];if(o.item==e){a.selectTab(o,t);break}}},registerTabs:function(e,t){var n=this,a=n.tabs[t||"default"];a||(n._createGroupHeader(t),a=n.tabs[t]);for(var i=n.element.querySelectorAll(".mcn-tabpages-headeritem"),r=0;r<i.length;r++){var o=i[r];!function(e){var i={element:e,link:{uri:e.getAttribute("data-tabtarget")}};e.mcnTab=i,a.tabGroup.appendChild(e),i.index=a.length,i.group=t,a.push(i),$(i.element).tap(function(){n.selectTab(i)})}(o)}},addTab:function(e){this.addTabs([e])},addTabs:function(e,t){var n=this,a=n.tabs[t||"default"];a||(n._createGroupHeader(t),a=n.tabs[t]);var i=a.tabGroup,r=n.tabHeaderTemplate;r&&(r=WinJSContrib.Utils.getTemplate(r)),e.forEach(function(e){var o=document.createElement("DIV");o.className="mcn-tabpages-headeritem",i.appendChild(o);var s={element:o,item:e,link:{uri:e.uri||e.href||n.tabLinkUri,args:e.args||null,oninvoked:e.invoked}};o.mcnTab=s,s.index=a.length,s.group=t,a.push(s),$(o).tap(function(){s.link.oninvoked?s.link.oninvoked(n,s):n.selectTab(s)}),r.render(e).done(function(e){for(;e.children.length>0;)o.appendChild(e.children[0])})})}})})}();