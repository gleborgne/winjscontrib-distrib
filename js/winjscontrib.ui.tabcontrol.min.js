!function(){"use strict";WinJS.Namespace.define("WinJSContrib.UI",{TabPages:WinJS.Class.define(function(e,t){var a=this;t=t||{},a.element=e||document.createElement("div"),a.element.className="mcn-tabpages "+a.element.className,WinJSContrib.CrossPlatform&&WinJSContrib.CrossPlatform.crossPlatformClass&&WinJSContrib.CrossPlatform.crossPlatformClass(a.element),a.tabHeader=t.header||e.querySelector(".mcn-tabpages-header"),a.tabHeaderTemplate=t.headerTemplate,a.tabContent=t.content||e.querySelector(".mcn-tabpages-content"),a.tabLinkUri=t.uri,a.tabLinkArgs=t.args,a.tabs={"default":[]},a.tabContent||(a.tabContent=document.createElement("DIV"),a.tabContent.className="mcn-tabpages-content",a.element.appendChild(a.tabContent)),a.navigator=new WinJSContrib.UI.PageControlNavigator(a.tabContent,{global:!1,delay:10}),a.navigator.animationWaitForPreviousPageClose=!1,a.navigator.animations.exitPage=WinJSContrib.UI.Animation.tabExitPage,a.navigator.animations.enterPage=WinJSContrib.UI.Animation.tabEnterPage,a.tabHeader||(a.tabHeader=document.createElement("DIV"),a.tabHeader.className="mcn-tabpages-header",a.element.appendChild(a.tabHeader)),a._createGroupHeader("default"),t.registerTabs&&a.registerTabs(),t.swipeSlide&&a.setSwipeSlideOnDefaultTab(t.rightbar)},{_createGroupHeader:function(e){var t=this;if(!t.tabs[e]||!t.tabs[e].tabGroup){var a=document.createElement("DIV");a.className="header-group-"+e+" mcn-tabpages-headergroup",t.tabs[e]||(t.tabs[e]=[]),t.tabs[e].tabGroup=a,t.tabHeader.appendChild(a)}},setSwipeRightbar:function(){var e=this;e.left="right",e.right="left"},setSwipeSlideOnDefaultTab:function(e){var t=this;e?t.setSwipeRightbar():(t.left="left",t.right="right"),t.swipeSlide=new WinJSContrib.UI.SwipeSlide(t.tabContent),t.navigator.animations.exitPage=function(e){return WinJSContrib.UI.Animation.fadeOut(e,100)},t.swipeSlide.onswipe=function(e){null!=t.currentTab&&(t.tabContent.style.opacity=0),null==t.currentTab?t.selectFirst():e.detail.direction==t.left?(t.selectByIndex(0==t.currentTab.item.index?t.tabs.default.length-1:t.currentTab.item.index-1),t.navigator.animations.enterPage=function(){"left"==t.left?WinJSContrib.UI.Animation.slideFromRight(t.tabContent):WinJSContrib.UI.Animation.slideFromLeft(t.tabContent)}):e.detail.direction==t.right&&(t.selectByIndex(t.currentTab.item.index==t.tabs.default.length-1?0:t.currentTab.item.index+1),t.navigator.animations.enterPage=function(){"right"==t.right?WinJSContrib.UI.Animation.slideFromLeft(t.tabContent):WinJSContrib.UI.Animation.slideFromRight(t.tabContent)})}},getPageLinkArgs:function(e){var t=this;return e.link.args||t.tabLinkArgs},getPageLink:function(e){var t=this;return e.link.uri||t.tabLinkUri?{uri:e.link.uri||t.tabLinkUri,args:t.getPageLinkArgs(e)}:void 0},selectFirst:function(e){this.selectTab(this.tabs.default[0],e)},selectTab:function(e,t){var a=this;if(e!=a.currentTab){var n=a.getPageLink(e);if(n){a.navigator.open(n.uri,n.args),a.currentTab=e;var i=a.tabHeader.querySelector(".mcn-tabpages-headeritem.current");i&&WinJS.Utilities.removeClass(i,"current"),t||a.selectTabHeader()}}},selectTabHeader:function(){var e=this;e.currentTab&&WinJS.Utilities.addClass(e.currentTab.element,"current")},selectByIndex:function(e,t,a){var n=this,i=n.tabs[a||"default"],r=i[e];r&&n.selectTab(r,t)},selectByItem:function(e,t,a){for(var n=this,i=n.tabs[a||"default"],r=0;r<i.length;r++){var s=i[r];if(s.item==e){n.selectTab(s,t);break}}},registerTabs:function(e,t){var a=this,n=a.tabs[t||"default"];n||(a._createGroupHeader(t),n=a.tabs[t]);for(var i=a.element.querySelectorAll(".mcn-tabpages-headeritem"),r=0;r<i.length;r++){var s=i[r];!function(e){var t={element:e,link:{uri:e.getAttribute("data-tabtarget")}};e.mcnTab=t,n.tabGroup.appendChild(e),n.push(t),$(t.element).tap(function(){a.selectTab(t)})}(s)}},addTab:function(e){this.addTabs([e])},addTabs:function(e,t){var a=this,n=a.tabs[t||"default"];n||(a._createGroupHeader(t),n=a.tabs[t]);var i=n.tabGroup,r=a.tabHeaderTemplate;r&&(r=WinJSContrib.Utils.getTemplate(r)),e.forEach(function(e){var t=document.createElement("DIV");t.className="mcn-tabpages-headeritem",i.appendChild(t);var s={element:t,item:e,link:{uri:e.uri||e.href||a.tabLinkUri,args:e.args||null,oninvoked:e.invoked}};t.mcnTab=s,n.push(s),$(t).tap(function(){s.link.oninvoked?s.link.oninvoked(a,s):a.selectTab(s)}),r.render(e).done(function(e){for(;e.children.length>0;)t.appendChild(e.children[0])})})}})})}();