!function(){"use strict";function e(e){console.log(e)}WinJS.Namespace.define("WinJSContrib.UI",{SwipeSlide:WinJS.Class.mix(WinJS.Class.define(function(e,t){this.element=e||document.createElement("DIV"),t=t||{},this.moveDivider=t.moveDivider||1,this.threshold=t.threshold||40,this.direction=t.direction||"horizontal",this.element.winControl||(this.element.winControl=this),this.element.classList.add("mcn-swipeslide"),this.element.classList.add("win-disposable"),this.target=this.element,this.eventTracker=new WinJSContrib.UI.EventTracker,this.ptDown=null,this.registerEvents(),this.allowed=t.allowed||{left:!0,right:!0},this.disabled=!1,WinJS.UI.setOptions(this,t)},{registerEvents:function(){void 0!==this.element.onpointerdown?(this.eventTracker.addEvent(this.element,"pointerdown",this._processDown.bind(this),!0),this.eventTracker.addEvent(this.element,"pointerup",this._processUp.bind(this),!0),this.eventTracker.addEvent(this.element,"pointermove",this._processMove.bind(this),!0)):void 0!==this.element.ontouchstart?(this.eventTracker.addEvent(this.element,"touchstart",this._processDown.bind(this),!0),this.eventTracker.addEvent(this.element,"touchend",this._processUp.bind(this),!0),this.eventTracker.addEvent(this.element,"touchcancel",this._processUp.bind(this),!0),this.eventTracker.addEvent(this.element,"touchmove",this._processMove.bind(this),!0)):(this.eventTracker.addEvent(this.element,"mousedown",this._processDown.bind(this),!0),this.eventTracker.addEvent(this.element,"mouseup",this._processUp.bind(this),!0),this.eventTracker.addEvent(this.element,"mouseleave",this._processUp.bind(this),!0),this.eventTracker.addEvent(this.element,"mousemove",this._processMove.bind(this),!0))},_initPtDown:function(e){var t=0,s=0;if(e.changedTouches){if(window.WebKitCSSMatrix){var i=new window.WebKitCSSMatrix(this.target.style.transform||this.target.style.webkitTransform||"");t=i.m41,s=i.m42}this.ptDown={x:e.changedTouches[0].screenX,y:e.changedTouches[0].screenY,confirmed:!1,transformOffsetX:t,transformOffsetY:s}}else{if(window.MSCSSMatrix){var i=new window.MSCSSMatrix(this.target.style.transform);t=i.m41,s=i.m42}this.ptDown={x:e.screenX,y:e.screenY,confirmed:!1,transformOffsetX:t,transformOffsetY:s}}},_processDown:function(e){this.disabled||this._initPtDown(e)},_processUp:function(t){{var s=this;t.currentTarget||t.target}if(t.pointerId&&s.element.releasePointerCapture)try{s.element.releasePointerCapture(t.pointerId)}catch(i){}if(s.ptDown){if(t.changedTouches)var n=s.ptDown.x-t.changedTouches[0].screenX,o=s.ptDown.y-t.changedTouches[0].screenY;else var n=s.ptDown.x-t.screenX,o=s.ptDown.y-t.screenY;if(Math.abs(n)>s.element.clientWidth/6){var r={dX:n,dY:o,move:-n-s.threshold,screenMove:s.ptDown.screenMove,direction:n>0?"left":"right",handled:!1};s.dispatchEvent("swipe",r),e("swipe slide, swipeHandled "+s.swipeHandled+"/"+r.handled+"/"+s.zurgl),s.swipeHandled||s._cancelMove()}else s._cancelMove()}else s._cancelMove();s.ptDown=null},_cancelMove:function(){var t=this.target,s=0,i=0;this.ptDown&&(s=this.ptDown.transformOffsetX,i=this.ptDown.transformOffsetY),e("swipe slide, cancel move "+s+"/"+i),t&&WinJS.UI.executeTransition(t,{property:"transform",delay:10,duration:400,easing:"ease-out",to:"translate("+s+"px,"+i+"px)"})},_processMove:function(t){if(!this.disabled)if(!this.ptDown&&t.changedTouches&&this._initPtDown(t),this.ptDown){if(t.changedTouches)var s=this.ptDown.x-t.changedTouches[0].screenX,i=this.ptDown.y-t.changedTouches[0].screenY;else var s=this.ptDown.x-t.screenX,i=this.ptDown.y-t.screenY;if(Math.abs(s)>5&&Math.abs(s)>Math.abs(i)&&(t.preventDefault(),t.stopPropagation()),!this.ptDown.confirmed){if(Math.abs(i)>this.threshold)return void(this.ptDown=null);if(Math.abs(s)>this.threshold){this.ptDown.confirmed=!0,this.swipeHandled=!1,e("start swipe"),this.dispatchEvent("swipestart");{t.currentTarget||t.target}t.pointerId&&this.element.setPointerCapture&&this.element.setPointerCapture(t.pointerId)}}if(this.ptDown.confirmed){var n=this.ptDown.transformOffsetX+(-s-this.threshold)/(window.devicePixelRatio*this.moveDivider);e("swipe move "+s+" / "+n);var o=this.setMove(n,-s);this.dispatchEvent("swipeprogress",{screenMove:o,move:-s-this.threshold})}}else e("swipe move")},setMove:function(t,s){return s>0&&!this.allowed.right?(t=Math.sqrt(t),t>this.element.clientWidth/6&&(t=this.element.clientWidth/6)):0>s&&!this.allowed.left&&(t=-Math.sqrt(-t),t<-(this.element.clientWidth/6)&&(t=-(this.element.clientWidth/6))),this.minMoveBounds&&t<this.minMoveBounds&&(t=this.minMoveBounds),this.maxMoveBounds&&t>this.maxMoveBounds&&(t=this.maxMoveBounds),this.ptDown&&(this.ptDown.screenMove=t),e("transform to "+t),void 0!==this.target.style.webkitTransform?this.target.style.webkitTransform="translate("+t+"px, 0)":this.target.style.transform="translate("+t+"px, 0)",t},dispose:function(){this.eventTracker.dispose();try{WinJS.Utilities.disposeSubTree(this.element)}catch(e){}}}),WinJS.UI.DOMEventMixin,WinJS.Utilities.createEventProperties("swipe","swipeprogress","swipestart"))})}();